var f=Object.defineProperty;var g=(a,e,i)=>e in a?f(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i;var u=(a,e,i)=>g(a,typeof e!="symbol"?e+"":e,i);import*as o from"https://cdn.skypack.dev/three@0.129.0/build/three.module.js";import{OrbitControls as w}from"https://cdn.skypack.dev/three@0.129.0/examples/jsm/controls/OrbitControls.js";import{GLTFLoader as M}from"https://cdn.skypack.dev/three@0.129.0/examples/jsm/loaders/GLTFLoader.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))t(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const r of n.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&t(r)}).observe(document,{childList:!0,subtree:!0});function i(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function t(s){if(s.ep)return;s.ep=!0;const n=i(s);fetch(s.href,n)}})();function p(a){const e=document.getElementById("overlay"),i=document.getElementById(a);if(e&&i){document.querySelectorAll(".popup").forEach(n=>{n.style.display="none",n.classList.remove("active")}),e.style.display="block",i.style.display="block",e.offsetWidth,i.offsetWidth,i.classList.add("active");const t=()=>{i.classList.remove("active"),setTimeout(()=>{e.style.display="none",i.style.display="none"},10)},s=i.querySelector(".close-btn");s&&(s.onclick=t),e.onclick=t,i.onclick=n=>n.stopPropagation()}}document.querySelectorAll("nav ul li a").forEach(a=>{a.addEventListener("click",e=>{e.preventDefault();const i=a.getAttribute("data-popup");i&&p(i)})});class b{constructor(e){u(this,"onWindowResize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)});u(this,"onClick",e=>{this.raycaster.setFromCamera(this.mouse,this.camera);const i=Array.from(this.highlightableObjects.values()).reduce((s,n)=>(n.isGroup?n.traverse(r=>{r.isMesh&&(r.userData.parentObject=n,s.push(r))}):n.isMesh&&s.push(n),s),[]),t=this.raycaster.intersectObjects(i,!1);if(t.length>0){const s=t[0].object,n=s.userData.parentObject||s;console.log(`Clicked: ${n.name}`);const r=this.externalLinks.get(n.name);if(r){window.open(r,"_blank","noopener,noreferrer");return}const c=this.objectToPopupMap.get(n.name);c&&p(c)}});u(this,"onMouseMove",e=>{const i=this.renderer.domElement.getBoundingClientRect(),t=e.clientX-i.left,s=e.clientY-i.top;this.mouse.x=t/this.renderer.domElement.clientWidth*2-1,this.mouse.y=-(s/this.renderer.domElement.clientHeight)*2+1,this.raycaster.setFromCamera(this.mouse,this.camera);const n=Array.from(this.highlightableObjects.values()).reduce((c,d)=>(d.isGroup?d.traverse(l=>{l.isMesh&&(l.userData.parentGroup=d,c.push(l))}):d.isMesh&&c.push(d),c),[]),r=this.raycaster.intersectObjects(n,!1);if(r.length>0){const c=r[0].object,l=c.userData.parentGroup||c;if(this.hoveredObject!==l)if(console.log(`Hovering: ${l.name}`),this.container.style.cursor="pointer",this.clearAllHighlights(),this.hoveredObject=l,l.isGroup)l.traverse(h=>{if(h.isMesh){const m=this.outlineMeshes.get(h.uuid);m&&(m.mesh.visible=!0,this.updateOutlineMesh(h,m.mesh))}});else{const h=this.outlineMeshes.get(l.uuid);h&&(h.mesh.visible=!0,this.updateOutlineMesh(l,h.mesh))}}else this.hoveredObject&&(this.container.style.cursor="default",this.clearAllHighlights(),this.hoveredObject=null)});u(this,"animate",()=>{requestAnimationFrame(this.animate),this.outlineMeshes.forEach(({mesh:e,originalObject:i})=>{e.visible&&(i.updateWorldMatrix(!0,!1),e.position.setFromMatrixPosition(i.matrixWorld),e.quaternion.setFromRotationMatrix(i.matrixWorld),e.scale.setFromMatrixScale(i.matrixWorld).multiplyScalar(1.05))}),this.controls.update(),this.renderer.render(this.scene,this.camera)});this.container=document.getElementById(e),this.scene=new o.Scene,this.highlightableObjects=new Map,this.outlineMeshes=new Map,this.originalScales=new Map,this.hoveredObject=null,this.externalLinks=new Map([["Github","https://github.com/Cooper-Kier"],["LinkedIn","https://www.linkedin.com/in/cooper-kier-b2bb112a0/"]]),this.objectToPopupMap=new Map([["Books","about"],["Flag","about"],["PC_Screen","projects"],["Case","experience"],["Football","extracurricular"],["Phone","contact"]]),this.mouse=new o.Vector2,this.raycaster=new o.Raycaster,this.raycaster.params.Line.threshold=.1,this.raycaster.params.Points.threshold=.1,this.initRenderer(),this.initCamera(),this.initControls(),this.initLights(),this.initEventListeners(),this.loadModel(),this.animate()}initRenderer(){this.renderer=new o.WebGLRenderer({alpha:!0,antialias:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=o.PCFSoftShadowMap,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.physicallyCorrectLights=!0,this.renderer.toneMapping=o.ACESFilmicToneMapping,this.renderer.toneMappingExposure=2.5,this.container.appendChild(this.renderer.domElement)}initCamera(){this.camera=new o.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),this.camera.position.set(2,1.5,2)}initControls(){this.controls=new w(this.camera,this.renderer.domElement),this.controls.enableZoom=!1,this.controls.maxAzimuthAngle=Math.PI/2,this.controls.minAzimuthAngle=0,this.controls.maxPolarAngle=Math.PI/3,this.controls.minPolarAngle=Math.PI/4,this.controls.enablePan=!1,this.controls.enableDamping=!0,this.controls.dampingFactor=.05,this.controls.rotateSpeed=.5}initLights(){const e=new o.DirectionalLight(16750899,3);e.position.set(5,5,5),e.castShadow=!0,this.setupShadowCamera(e),this.scene.add(e);const i=new o.SpotLight(26367,4);i.position.set(-3,2,-3),i.angle=Math.PI/4,i.penumbra=.5,i.decay=1.5,i.distance=20,this.scene.add(i);const t=new o.PointLight(16777215,2,10);t.position.set(-2,1,2),this.scene.add(t);const s=new o.PointLight(65535,2,8);s.position.set(2,.5,-2),this.scene.add(s);const n=new o.PointLight(0,2,8);n.position.set(0,5,0),this.scene.add(n);const r=new o.AmbientLight(2236962,2);this.scene.add(r)}setupShadowCamera(e){e.shadow.mapSize.width=2048,e.shadow.mapSize.height=2048,e.shadow.camera.near=.5,e.shadow.camera.far=50,e.shadow.camera.left=-10,e.shadow.camera.right=10,e.shadow.camera.top=10,e.shadow.camera.bottom=-10}initEventListeners(){this.container.addEventListener("mousemove",this.onMouseMove.bind(this)),this.container.addEventListener("click",this.onClick.bind(this)),window.addEventListener("resize",this.onWindowResize.bind(this))}loadModel(){const e=new M,i=new o.MeshBasicMaterial({color:16777215,side:o.BackSide}),t=new o.LoadingManager;t.onError=function(s){console.error("Error loading:",s)},e.setPath("/models/"),e.load("Room.glb",s=>{const n=s.scene;this.processSceneObjects(n,i),this.scene.add(n)},s=>{console.log(s.loaded/s.total*100+"% loaded")},s=>{console.error("An error occurred loading the model:",s)})}processSceneObjects(e,i){e.traverse(t=>{(t.name==="Football"||t.name==="Case"||t.name==="PC_Screen"||t.name==="Books"||t.name==="Phone"||t.name==="Flag"||t.name==="Github"||t.name==="LinkedIn")&&(t.isMesh?(t.castShadow=!0,t.name&&(this.highlightableObjects.set(t.name,t),this.createOutlineMesh(t,i),this.originalScales.set(t.uuid,t.scale.clone()))):t.isGroup&&t.name&&(this.highlightableObjects.set(t.name,t),t.traverse(s=>{s.isMesh&&(this.createOutlineMesh(s,i),this.originalScales.set(s.uuid,s.scale.clone()))}))),t.name==="Football"?this.football=t:t.name==="Case"?this.case=t:t.name==="PC_Screen"?this.pc=t:t.name==="Books"?this.book=t:t.name==="Phone"?this.phone=t:t.name==="Github"?this.git=t:t.name==="LinkedIn"?this.linked=t:t.name==="Flag"&&(this.flag=t)})}clearAllHighlights(){this.outlineMeshes.forEach(({mesh:e,originalObject:i})=>{e.visible=!1;const t=this.originalScales.get(i.uuid);t&&i.scale.copy(t)})}createOutlineMesh(e){const i=e.geometry.clone(),t=new o.MeshBasicMaterial({color:16777215,side:o.BackSide,transparent:!0,opacity:.1}),s=new o.Mesh(i,t);this.scene.add(s),s.matrixAutoUpdate=!0,e.updateWorldMatrix(!0,!1),s.position.setFromMatrixPosition(e.matrixWorld),s.quaternion.setFromRotationMatrix(e.matrixWorld),s.scale.setFromMatrixScale(e.matrixWorld).multiplyScalar(1),s.visible=!1,this.outlineMeshes.set(e.uuid,{mesh:s,originalObject:e})}updateOutlineMesh(e,i){e.updateWorldMatrix(!0,!1),i.position.setFromMatrixPosition(e.matrixWorld),i.quaternion.setFromRotationMatrix(e.matrixWorld),i.scale.setFromMatrixScale(e.matrixWorld).multiplyScalar(1)}}new b("container3D");
